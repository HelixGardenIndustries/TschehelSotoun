<!DOCTYPE html>
<html lang="en">
<head>
    <title>three.js webgl - geometry - shapes</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        body {
        font-family: Monospace;
        background-color: #f0f0f0;
        margin: 0px;
        overflow: hidden;
        }
    </style>
</head>
<body>
<canvas id="debug" style="position:absolute; left:100px"></canvas>

<script src="/js/lib/Three.js"></script>

<script>

var container;

var camera, scene, renderer;

var group, text, plane;

var targetRotation = 0;
var targetRotationOnMouseDown = 0;

var mouseX = 0;
var mouseXOnMouseDown = 0;

var windowHalfX = window.innerWidth / 2;
var windowHalfY = window.innerHeight / 2;

init();
animate();

function init() {

container = document.createElement( 'div' );
document.body.appendChild( container );


camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 1000 );
camera.position.set( 0, 150, 500 );

scene = new THREE.Scene();



group = new THREE.Object3D();
group.position.y = 50;
scene.add( group );

function addShape( shape, extrudeSettings, color, x, y, z, rx, ry, rz, s ) {

var points = shape.createPointsGeometry();
var spacedPoints = shape.createSpacedPointsGeometry( 100 );

// flat shape

/*var geometry = new THREE.ShapeGeometry( shape );

var mesh = THREE.SceneUtils.createMultiMaterialObject( geometry, [ new THREE.MeshLambertMaterial( { color: color } ), new THREE.MeshBasicMaterial( { color: 0x000000, wireframe: true, transparent: true } ) ] );
mesh.position.set( x, y, z - 125 );
mesh.rotation.set( rx, ry, rz );
mesh.scale.set( s, s, s );
group.add( mesh );*/

// 3d shape

var geometry = new THREE.ExtrudeGeometry( shape, extrudeSettings );

var mesh = THREE.SceneUtils.createMultiMaterialObject( geometry, [ new THREE.MeshLambertMaterial( { color: color } ), new THREE.MeshBasicMaterial( { color: 0x000000, wireframe: true, transparent: true } ) ] );
mesh.position.set( x, y, z - 75 );
mesh.rotation.set( rx, ry, rz );
mesh.scale.set( s, s, s );
group.add( mesh );




}

// Fish
x = y = 0;
var fishShape = new THREE.Shape();
fishShape.moveTo(x,y);
fishShape.quadraticCurveTo(x + 50, y - 80, x + 90, y - 80);
fishShape.quadraticCurveTo(x + 100, y - 80, x + 115, y - 80);
fishShape.quadraticCurveTo(x + 115, y, x + 115, y + 80);
fishShape.quadraticCurveTo(x + 100, y + 80, x + 90, y + 80);
fishShape.quadraticCurveTo(x + 50, y + 80, x, y);

// Spline shape + path extrusion

var splinepts = [];
splinepts.push( new THREE.Vector2 ( 350, 100 ) );
splinepts.push( new THREE.Vector2 ( 400, 450 ) );
splinepts.push( new THREE.Vector2 ( -140, 350 ) );
splinepts.push( new THREE.Vector2 ( 0, 0 ) );

var splineShape = new THREE.Shape( );
splineShape.moveTo( 0, 0 );
splineShape.splineThru( splinepts );

// splineShape.debug( document.getElementById("debug") );

// TODO 3d path?

var apath = new THREE.SplineCurve3();
apath.points.push(new THREE.Vector3(-50, 150, 10));
apath.points.push(new THREE.Vector3(-20, 180, 20));
apath.points.push(new THREE.Vector3(40, 220, 50));
apath.points.push(new THREE.Vector3(200, 290, 100));


var extrudeSettings = { amount: 20 }; // bevelSegments: 2, steps: 2 , bevelSegments: 5, bevelSize: 8, bevelThickness:5

// addShape( shape, color, x, y, z, rx, ry,rz, s );

//addShape( californiaShape, extrudeSettings, 0xffaa00, -300, -100, 0, 0, 0, 0, 0.25 );

extrudeSettings.bevelEnabled = true;
extrudeSettings.bevelSegments = 2;
extrudeSettings.steps = 2;

addShape( fishShape, extrudeSettings, 0x222222, -60, 200, 0, 0, 0, 0, 1 );

extrudeSettings.extrudePath = apath;
extrudeSettings.bevelEnabled = false;
extrudeSettings.steps = 20;


renderer = new THREE.WebGLRenderer( { antialias: true } );
renderer.setClearColor( 0xf0f0f0 );
renderer.setSize( window.innerWidth, window.innerHeight );

container.appendChild( renderer.domElement );

}


function animate() {

requestAnimationFrame( animate );

render();


}

function render() {

group.rotation.y += ( targetRotation - group.rotation.y ) * 0.05;
renderer.render( scene, camera );

}

</script>

</body>
</html>